## Заметка
Все сложные слова со сноской находятся в словаре. Ссылка на [[Словарь]]

В SQL существует несколько способов объявления и использования переменных. Они позволяют вам сохранять значения и использовать их в последующих частях запроса. 

Рассмотрим основные методы:
### Объявление и использование переменных с помощью DECLARE и SET
DECLARE используется для объявления переменной, а SET - для присвоения ей значения.
```SQL
DECLARE @MyVariable INT; -- Объявляем переменную типа INT
SET @MyVariable = 10; -- Присваиваем переменной значение

SELECT @MyVariable AS 'Value'; --Используем переменную в запросе
```
### Объявление и присвоение значения переменной одновременно
Также можно объявить переменную и сразу присвоить ей значение
```SQL
DECLARE @AnotherVariable VARCHAR(50) = 'Hello, World!';
SELECT @AnotherVariable AS 'Greeting';
```
### Использование переменной в условии
```SQL
DECLARE @Threeshold INT --Объявляем переменную @Threeshold типа INT
SET @Threeshold = 100 --Присваиваем значение 100
 
SELECT ProductName, Price
FROM Products
WHERE Price > @Threeshold --используем переменную в условии WHERE, чтобы выбрать товары, цена которых выше уазанного порога.
```

## Синтаксис передачи переменных из массивов
В некоторых случаях может потребоваться работа с набором значений, подобным массиву. В SQL нет явных массивов, но можно использовать таблицы и временные таблицы для хранения нескольких значений и последующего использования их в запросах.
### Использование временной таблицы как массива
```SQL
DECLARE @IDs TABLE (ID INT); -- Объявляем временную таблицу

-- Добавляем данные в временную таблицу
INSERT INTO @IDs (ID)
VALUES (1), (2), (3), (4);

-- Используем значения из временной таблицы
SELECT ID
FROM @IDs
WHERE ID > 2;
```

### Использование временной таблицы в основном запросе
Временные таблицы могут использоваться в более сложных запросах для выполнения объединений, фильтрации и других операций
```SQL
DECLARE @ValidIDs TABLE (ID INT);

-- Добавляем данные в временную таблицу
INSERT INTO @ValidIDs (ID)
VALUES (1),(3),(5);

-- Оcновной запрос с использованием временной таблицы
SELECT P.ProductName, P.Price
FROM Products P
JOIN @ValidIDs V ON P.productID = V.ID;
```
## Передача переменных в запрос из внешних систем 
Передача переменных в SQL-запросы из внешних систем (например, программ на языках программирования) является распространенной практикой. Это позволяет динамически управлять запросами, в зависимости от данных, поступающих извне.
Python с библиотекой `pyodbc` позволяет выполнять SQL-запросы с передачей параметров.
```python
inport pyodbc

# Установка соединения с базой данных
conn = puodbc.connect('DRIVER={SQL Server}; SERVER = server_name; DATABASE=db_name;UID=user;PWD=password')

# Переменные, которые будут переданы в запрос
param1 = 100
param2 = 'Some text'

# Подготовка запроса с параметрами
query = "SELECT * FROM table_name WHERE column1 = ? AND column2 = ?"

# Выполнение запроса с передачей переменных
cursor = conn.cursor()
cursor.execute(query, (param1, param2))

# Извлечение данных
rows = cursor.fetchall()
for row ib rows:
	print(row)

# Закрытие соединения
conn.close()
```
Использование переменных в SQL-Запросах предоставляет мощные инструменты для динамического и гибкого выполнения запросов. Вы можете объявлять переменные и использовать их в разных частях запросов, передавать массивы данных через временные таблицы, а также интегрировать SQL с внешними системами, передавая параметры запросов из программ на других языках программирования. Это позволяет автоматизировать и улучшать взаимодействие с базой данных, делая процессы более эффективными и безопасными.


