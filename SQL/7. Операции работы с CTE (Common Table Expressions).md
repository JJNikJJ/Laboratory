## Заметка
Все сложные слова со сноской находятся в словаре. Ссылка на [[Словарь]]

В SQL операции работы с CTE (Common Table Expression), простые и коррелированные подзапросы ,а также рекурсия, являются важными инструментами для выполнения сложных запросов и обработки данных. 

## CTE (Common Table Expressions)
CTE - это временные результирующие наборы, которые могут быть определены в предложении WITH и могут использоваться в последующем запросе. CTE упрощают создание сложных запросов и улучшают их читаемость.

### Пример простого CTE:
```SQL 
WITH Sales_CTE AS (
	SELECT employees_if, SUM(sales_amount) AS total_sales
	FROM sales
	GROUP BY employee_id
)
SELECT employee_id, total_sales
FROM Sales_CTE
WHERE total_sales > 10000;
```
Здесь Sales_CTE создается как временный результирующий набор, который используется в основном запросе.

## Простые и коррелированные подзапросы 
Подзапрос - это запрос, который вложен в другой запрос. Подзапросы могут использоваться в различных частях SQL-запроса, например, в `SELECT, WHERE, FROM и т.д.`
### Простой подзапрос
Простой подзапрос не зависит от внешнего запроса.
```SQL
SELECT employee_id, name
FROM employees
WHERE department_id = (SELECT department_id FROM departments WHERE department_name = 'Sales');
```
Этот подзапрос возвращает department_id для отдела с именем Sales, и этот идентификатор используется во внешнем запросе для фильтрации сотрудников.

### Коррелированный подзапрос
Коррелированный подзапрос зависит от внешнего запроса. Он выполняется для каждой строки внешнего запроса.
```SQL
SELECT e1.name, e1.salary
FROM employees e1
WHERE e1.salary > (SELECT AVG(e2.salary) FROM employees e2 WHERE e1.department_id = e2.department_id);
```
	Этот запрос возвращает имена и зарплаты сотрудников, чья зарплата выше средне по их отделу.
	Здесь подзапрос зависит от текущей строки внешнего запроса (e1.department_id = e2.department_id)
## Рекурсия в SQL
Рекурсия в SQL используется для работы и иерархическими данными, такими как структуры директорий или организационные структуры. Рекурсивные запросы обычно выполняются с использованием CTE.
### Пример рекурсивного CTE
